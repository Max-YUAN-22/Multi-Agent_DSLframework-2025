{"ast":null,"code":"import _objectSpread from\"/Users/Apple/Desktop/multi-agent-dsl-final/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useReducer,useCallback,useRef}from'react';import useWebSocket from'../hooks/useWebSocket';import{jsx as _jsx}from\"react/jsx-runtime\";const EventContext=/*#__PURE__*/createContext();const initialState={events:[],traffic:{},weather:{},parking:{},safety:{}};const eventReducer=(state,action)=>{switch(action.type){case'ADD_EVENT':return _objectSpread(_objectSpread({},state),{},{events:[action.payload,...state.events]});case'CLEAR_EVENTS':return _objectSpread(_objectSpread({},state),{},{events:[]});case'SET_TRAFFIC':return _objectSpread(_objectSpread({},state),{},{traffic:action.payload});case'SET_WEATHER':return _objectSpread(_objectSpread({},state),{},{weather:action.payload});case'SET_PARKING':return _objectSpread(_objectSpread({},state),{},{parking:action.payload});case'SET_SAFETY':return _objectSpread(_objectSpread({},state),{},{safety:action.payload});default:return state;}};export const EventProvider=_ref=>{let{children}=_ref;const[state,dispatch]=useReducer(eventReducer,initialState);const idCounter=useRef(0);const backendPort=process.env.REACT_APP_BACKEND_PORT||8000;const wsUrl=\"ws://localhost:\".concat(backendPort,\"/ws\");const onMessage=useCallback(message=>{const newEvent=_objectSpread(_objectSpread({},JSON.parse(message.data)),{},{id:idCounter.current++,// Use a counter for unique IDs\nat:new Date().toLocaleTimeString()});dispatch({type:'ADD_EVENT',payload:newEvent});},[dispatch]);const clearEvents=useCallback(()=>{dispatch({type:'CLEAR_EVENTS'});},[dispatch]);const{sendMessage,readyState}=useWebSocket(wsUrl,onMessage);return/*#__PURE__*/_jsx(EventContext.Provider,{value:{state,dispatch,sendMessage,readyState,clearEvents},children:children});};export const useEventContext=()=>useContext(EventContext);","map":{"version":3,"names":["React","createContext","useContext","useReducer","useCallback","useRef","useWebSocket","jsx","_jsx","EventContext","initialState","events","traffic","weather","parking","safety","eventReducer","state","action","type","_objectSpread","payload","EventProvider","_ref","children","dispatch","idCounter","backendPort","process","env","REACT_APP_BACKEND_PORT","wsUrl","concat","onMessage","message","newEvent","JSON","parse","data","id","current","at","Date","toLocaleTimeString","clearEvents","sendMessage","readyState","Provider","value","useEventContext"],"sources":["/Users/Apple/Desktop/multi-agent-dsl-final/frontend/src/contexts/EventContext.js"],"sourcesContent":["import React, { createContext, useContext, useReducer, useCallback, useRef } from 'react';\nimport useWebSocket from '../hooks/useWebSocket';\n\nconst EventContext = createContext();\n\nconst initialState = {\n  events: [],\n  traffic: {},\n  weather: {},\n  parking: {},\n  safety: {},\n};\n\nconst eventReducer = (state, action) => {\n  switch (action.type) {\n    case 'ADD_EVENT':\n      return { ...state, events: [action.payload, ...state.events] };\n    case 'CLEAR_EVENTS':\n      return { ...state, events: [] };\n    case 'SET_TRAFFIC':\n      return { ...state, traffic: action.payload };\n    case 'SET_WEATHER':\n      return { ...state, weather: action.payload };\n    case 'SET_PARKING':\n      return { ...state, parking: action.payload };\n    case 'SET_SAFETY':\n      return { ...state, safety: action.payload };\n    default:\n      return state;\n  }\n};\n\nexport const EventProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(eventReducer, initialState);\n  const idCounter = useRef(0);\n\n  const backendPort = process.env.REACT_APP_BACKEND_PORT || 8000;\n  const wsUrl = `ws://localhost:${backendPort}/ws`;\n\n  const onMessage = useCallback((message) => {\n    const newEvent = {\n      ...JSON.parse(message.data),\n      id: idCounter.current++, // Use a counter for unique IDs\n      at: new Date().toLocaleTimeString(),\n    };\n\n    dispatch({ type: 'ADD_EVENT', payload: newEvent });\n  }, [dispatch]);\n\n  const clearEvents = useCallback(() => {\n    dispatch({ type: 'CLEAR_EVENTS' });\n  }, [dispatch]);\n\n  const { sendMessage, readyState } = useWebSocket(wsUrl, onMessage);\n\n  return (\n    <EventContext.Provider value={{ state, dispatch, sendMessage, readyState, clearEvents }}>\n      {children}\n    </EventContext.Provider>\n  );\n};\n\nexport const useEventContext = () => useContext(EventContext);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}